--Op+P Make Proj Cue ask Input(*
Tested with QLab v3.2.14 Oct 2018
Please report any issues to robotlightsyou@gmail.com with subject "QLAB 3 template issues"
*) 
global dialogTitle
set dialogTitle to "Make Projector Cues"

tell application id "com.figure53.QLab.4" to tell front workspace
	
	set actionsList to {"Mute.Vid.", "UnMute.Vid.", "Input.Proj.", "OnPower.Vid.", "OffPower.Vid."}
	set whichCue to my pickFromList(actionsList, "What action?")
	
	set sourceList to {"1", "2", "3"}
	set whichProjector to my pickFromList(sourceList, "Which Projectors?")
	
	my makeNewScript(whichCue, whichProjector)
	
end tell


on pickFromList(theChoice, thePrompt) -- [Shared subroutine]
	tell application id "com.figure53.QLab.4"
		choose from list theChoice with prompt thePrompt with title dialogTitle default items item 1 of theChoice
		if result is not false then
			return item 1 of result
		else
			error number -128
		end if
	end tell
end pickFromList


on makeNewScript(myaction, mySource)
	tell application id "com.figure53.QLab.4" to tell front workspace
		
		set refCue to (myaction & mySource)
		set newName to q name of cue refCue
		make type "Script"
		set newQ to last item of (selected as list)
		set mySourceScript to (script source of cue refCue)
		set the properties of newQ to {q name:newName, script source:mySourceScript}
		
	end tell
end makeNewScript
